function vektorResultDevices(e){VektorChooser.resultDevices=new VektorChooser.DeviceCollection(e)}function vSearch(e){jQuery("#result-area").html("<h1>Araçlar<h1>"),VektorChooser.resultDevices=VektorChooser.devices;var t=e.get("filters");_.each(t,function(e,t){VektorChooser.filteredDevices=VektorChooser.resultDevices.filterBy(e.key,e.value),console.log(e,t),vektorResultDevices(VektorChooser.filteredDevices)}),VektorChooser.resultDevices.forEach(function(e,t){console.log(t,e.get("name")),jQuery("#result-area").append("<h2>"+e.get("name")+"<h2>")}),VektorChooser.events.trigger("result.update",VektorChooser.resultDevices)}var VektorChooser=VektorChooser||{},dataModel,filterModel,resultModel;!function(){"use strict";VektorChooser.deviceList={},VektorChooser.currentView={},VektorChooser.defaultProps=["Konum Takibi","Yolculuk Raporu","Anlık Uyarılar","Kural Tanımlama","Geçmiş Konumlar","Kendi Haritanı Yarat","Mesai İçi ve Dışı Kullanım","Rota Takibi","Otomatik Raporlama"],jQuery(function(){VektorChooser.devices=new VektorChooser.DeviceCollection,_.each(VektorChooser.deviceList,function(e){VektorChooser.devices.add(e)}),dataModel=new VektorChooser.DataModel,filterModel=new VektorChooser.FilterModel,resultModel=new VektorChooser.ResultModel,VektorChooser.currentView.form=new VektorChooser.FormView(dataModel,filterModel,resultModel)})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.DeviceCollection=Backbone.Collection.extend({model:VektorChooser.DeviceModel,getPageByOrder:function(e){return this.filter(function(t){return t.get("globalOrder")==e})},filterBy:function(e,t){return this.filter(function(o){var r=o.get(e);return _.isArray(r)?_.indexOf(r,t)>=0?!0:!1:o.get(e)==t})},getCurrentPage:function(){return this.filter(function(e){return 1==e.get("isCurrent")})}})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.events={},_.extend(VektorChooser.events,Backbone.Events),VektorChooser.events.on("device.search",function(e){window.vSearch(e)}),VektorChooser.events.on("result.update",function(e){resultModel.set("devices",e)})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.DataModel=Backbone.Model.extend({defaults:{vehicleTypes:["Binek-Hafif Ticari","Ağır Vasıta","Frigo Treyler","Portatif","Motorsiklet"],props:["Konum Takibi","Yolculuk Raporu","Anlık Uyarılar","Kural Tanımlama","Geçmiş Konumlar","Kendi Haritanı Yarat","Mesai İçi ve Dışı Kullanım","Rota Takibi","Otomatik Raporlama","Yakıt Tüketim Raporu","Sürüş Analizi","Gerçek KM Tüketim","Tak-Çalıştır","Kablolu Montaj","Taşınabilir"],additionalProps:[]},initialize:function(){}})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.DeviceModel=Backbone.Model.extend({defaults:{name:"",vehicleTypes:[],props:[],additionalProps:[]},initialize:function(){this.setProps()},setProps:function(){var e=VektorChooser.defaultProps;this.set("props",e.concat(this.get("props")))}})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.FilterModel=Backbone.Model.extend({defaults:{filters:[],changeTime:"",vehicleTypes:[],props:[]},initialize:function(){this.updateChangeTime(),this.on("change:filters",this.setFilters)},resetFiltersTypes:function(){this.set("vehicleTypes",[]),this.set("props",[])},setFilters:function(){var e=this.get("filters");this.resetFiltersTypes();var t=this;_.each(e,function(e){"vehicleTypes"==e.key?t.updateFilterItem(e,!0):t.updateFilterItem(e,!1)}),this.updateChangeTime(),VektorChooser.events.trigger("device.search",this)},updateChangeTime:function(){var e=new Date;this.set("changeTime",e.getTime())},updateFilterItem:function(e,t){var o=this.get(e.key);_.isArray(o)&&!t?o.push(e.value):o=[e.value],this.set(e.key,o)},search:function(){window.vSearch(this)}})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.ResultModel=Backbone.Model.extend({defaults:{devices:!1,changeTime:"",vehicleTypes:[],props:[]},initialize:function(){this.on("change:devices",this.setResults)},resetModel:function(){this.set("vehicleTypes",[]),this.set("props",[])},setResults:function(){var e=this.get("devices");return console.log(e),e?(this.resetModel(),e.forEach(function(e){var t=_.union(window.resultModel.get("props"),e.get("props"));window.resultModel.set("props",t)}),void this.updateChangeTime()):!1},updateChangeTime:function(){var e=new Date;this.set("changeTime",e.getTime())}})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VDrive=new VektorChooser.DeviceModel({name:"VDrive",vehicleTypes:["Binek-Hafif Ticari","Ağır Vasıta"],props:["Tak-Çalıştır","Yakıt Tüketim Raporu","Sürüş Analizi","Gerçek KM Tüketim"],additionalProps:[]})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VDriveLite=new VektorChooser.DeviceModel({name:"VDrive Lite",vehicleTypes:["Binek-Hafif Ticari"],props:["Tak-Çalıştır"]})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VFleet=new VektorChooser.DeviceModel({name:"VFleet",vehicleTypes:["Binek-Hafif Ticari","Ağır Vasıta"],props:["Kablolu Montaj"],additionalProps:["Mesajlaşma","Navigasyon","Görev Atama","Isı","Depo","Menhol","Vana/Sayaç","Kapı","Sürücü"]})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VFleetCan=new VektorChooser.DeviceModel({name:"VFleet CAN",vehicleTypes:["Ağır Vasıta"],props:["Kablolu Montaj","Yakıt Tüketim Raporu","Sürüş Analizi","Gerçek KM Tüketim"],additionalProps:["Mesajlaşma","Navigasyon","Görev Atama","Isı","Depo","Menhol","Vana/Sayaç","Kapı","Sürücü"]})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VMax=new VektorChooser.DeviceModel({name:"VMax",vehicleTypes:["Binek-Hafif Ticari","Frigo Treyler"],props:["Kablolu Montaj","Yakıt Tüketim Raporu","Sürüş Analizi","Gerçek KM Tüketim"],additionalProps:["Yakıt Tüketim Raporu","Sürüş Analizi","Gerçek KM Takibi"]})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VMini=new VektorChooser.DeviceModel({name:"VMini",vehicleTypes:["Portatif"],props:["Taşınabilir"],additionalProps:[]})}();var VektorChooser=VektorChooser||{};!function(){"use strict";VektorChooser.deviceList.VMoto=new VektorChooser.DeviceModel({name:"VMoto",vehicleTypes:["Motorsiklet"],props:[],additionalProps:[]})}();var VektorChooser=VektorChooser||{};VektorChooser.FormView=Backbone.View.extend({tagName:"div",template:"",events:{"change .vc-filter-item":"updateFilters"},initialize:function(e,t,o){_.bindAll(this,"render"),this.dataModel=e,this.filterModel=t,this.resultModel=o,this.template=_.template(jQuery("#form-template").html()),this.render(),this.dataModel.on("change",this.render),this.filterModel.on("change:changeTime",this.render),this.resultModel.on("change:changeTime",this.render)},render:function(){return this.$el.html(this.template({data:this.dataModel.toJSON(),filter:this.filterModel.toJSON(),result:this.resultModel.toJSON()})),jQuery("#vc-form").append(this.$el),this},updateFilters:function(e){var t=jQuery(e.currentTarget);"vehicleTypes"==t.data("filter")&&jQuery(".vc-filter-item--props").attr("checked",!1);var o=[];jQuery(".vc-filter-item:checked,.vc-filter-item:selected").each(function(){var e=jQuery(this),t=e.data("filter"),r=e.val(),i={key:t,value:r};o.push(i)}),this.filterModel.set("filters",o)}});